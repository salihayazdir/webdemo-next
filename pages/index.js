import Head from 'next/head'
import Image from 'next/image'
import axios from 'axios'

export default function Home({res}) {
  
  console.log(res)
  
  return (
    <div>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main>
        <h1 className="">
          asd
        </h1>
      </main>
    </div>
  )
}

export async function getStaticProps() {
  
  try {
    console.log('asd')
    const token = process.env.NEXT_PUBLIC_STRAPI_TOKEN;
    axios.defaults.headers.common = {'Authorization': `bearer ${token}`}

    const res = await axios.get(`${process.env.NEXT_PUBLIC_STRAPI_URL}/categories`, {
      params: { populate: '*' }
    });

    test = res.json()

    return { props: { res } }

  } catch (error) {
    console.error(error);
    return { props: "Error" }
  }

}